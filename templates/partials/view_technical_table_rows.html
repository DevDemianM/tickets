{% for ticket in tickets %}
{% if ticket.state != 'Terminado' %}
<tr class="align-middle ticket-row" data-status="{{ ticket.state }}" data-city="{{ ticket.city }}" data-ticket-id="{{ ticket.id_ticket }}">
    <td class="ps-3 fw-bold">#{{ ticket.id_ticket }}</td>
    <td>{{ ticket.reference }}</td>
    <td>
        <select class="form-select form-select-sm status-select" data-ticket-id="{{ ticket.id_ticket }}">
            <option value="Asignado" {% if ticket.state=='Asignado' %}selected{% endif %}>Asignado</option>
            <option value="En proceso" {% if ticket.state=='En proceso' %}selected{% endif %}>En proceso</option>
            <option value="En Revision" {% if ticket.state=='En Revision' %}selected{% endif %}>En Revision</option>
        </select>
    </td>
    <td>
        <span class="badge {% if ticket.priority == 'Alta' %}bg-danger{% elif ticket.priority == 'Media' %}bg-warning text-dark{% else %}bg-success{% endif %}">
            {{ ticket.priority }}
        </span>
    </td>
    <td>
        {% if ticket.type_of_service == "0" %}
        <span class="badge bg-info">Servicio Técnico</span>
        {% elif ticket.type_of_service == "1" %}
        <span class="badge bg-secondary">Reparación Interna</span>
        {% elif ticket.type_of_service == "2" %}
        <span class="badge bg-warning text-dark">Garantía</span>
        {% else %}
        <span class="badge bg-dark">Otro</span>
        {% endif %}
    </td>
    <td>
        {% if ticket.problems %}
        <div class="d-flex flex-wrap gap-1">
            {% for problem in ticket.problems %}
            <span class="badge bg-secondary">{{ problem.name }}</span>
            {% endfor %}
        </div>
        {% else %}
        <span class="text-muted">Sin problemas registrados</span>
        {% endif %}
    </td>
    <td>
        <span class="badge bg-secondary">{{ ticket.city }}</span>
    </td>
    <td class="text-center">
        <div class="btn-group">
            <a href="{{ url_for('tickets.view_technical.technician_ticket_detail', ticket_id=ticket.id_ticket) }}" 
               class="btn btn-sm btn-outline-info" title="Ver detalles">
                <i class="fas fa-eye"></i>
            </a>
        </div>
    </td>
</tr>
{% endif %}
{% else %}
<tr>
    <td colspan="8" class="text-center py-5">
        <i class="fas fa-ticket-alt fa-3x mb-3 text-muted"></i>
        <p class="text-muted">No tienes tickets asignados con los filtros seleccionados.</p>
    </td>
</tr>
{% endfor %} 